#!/bin/sh

# Enforce npm as the only package manager for this project

# List of unwanted lock files
check_files="yarn.lock pnpm-lock.yaml bun.lockb"

echo "üîç Checking package manager..."

# Check for unwanted lock files in staged changes
for file in $check_files; do
    if git diff --cached --name-only | grep -qE "^$file$"; then
        echo ""
        echo "‚ùå Error: This project uses npm as the package manager."
        echo "   Found: $file"
        echo ""
        echo "   Please remove this file and use npm instead:"
        echo "   $ git rm $file"
        echo "   $ npm install"
        echo ""
        exit 1
    fi
done

# Ensure package-lock.json exists
if [ ! -f "package-lock.json" ]; then
    echo ""
    echo "‚ùå Error: package-lock.json is missing."
    echo "   Run 'npm install' to generate it."
    echo ""
    exit 1
fi

echo "‚úÖ Package manager check passed (npm)"
